# 시스템 콜
![image](https://github.com/dlrkdus/CS_STUDY/assets/99721126/e2d1c276-553a-4ca2-8833-931973b83759)


운영체제는 응용 프로그램의 CPU에 대한 직접적인 접근을 제한하고 있다. <br>
따라서 응용 프로그램은 **운영 체제 커널과 응용 프로그램 간의 인터페이스**를 통해 CPU에 접근할 수 있다.<br>

## 운영체제의 이중동작
![image](https://github.com/dlrkdus/CS_STUDY/assets/99721126/7cd6a27e-939d-45a6-a009-4ebcee0e728d)

시스템콜을 설명하기에 앞서 이중동작 설명은 필수불가결 하다. <br>
운영체제는 크게 **사용자 모드**와 **커널 모드**로 돌아간다. <br>
이는 사용자 프로그램이 시스템 자원에 직접 접근할 시 위험을 방지하고 시스템의 안정화를 목적으로 한다. <br>

### 사용자 모드
사용자 모드는 일반적으로 사용자 애플리케이션들이 실행되는 환경이다. <br>
이 환경에서 응용 프로그램은 필요한 시스템 자원에만 접근할 수 있다. <br>
사용자가 **특권 명령**이나 다른 프로세스 영역에 접근을 시도한다면 이를 트랩으로 방지한다. <br>
사용자 모드에서는 **모드비트가 1**이다.

### 커널 모드 
커널 모드(특권 모드)는 운영 체제의 핵심 부분이 실행되는 환경이다. <br>
이 환경에서는 운영체제의 핵심 기능 및 하드웨어 자원에 접근할 수 있다. (메모리 기능, 인터럽트 처리 등) <br>
이 커널 모드에서 처리하는 것이 시스템 콜이다. <br>
커널 모드에서는 **모드비트가 0**이다.

>**모드비트**<br>
>현재 실행 중인 코드가 사용자 모드인지 커널 모드인지를 결정하는 비트이다.<br>

**즉 시스템 콜은 커널 영역의 기능을 사용자 모드가 사용 가능하게, 프로세스가 하드웨어에 직접 접근해서 필요한 기능을 사용할 수 있게 해준다.**
<hr>

## 시스템 콜 동작 과정 
![image](https://github.com/dlrkdus/CS_STUDY/assets/99721126/c3770cf8-9e46-4d3f-869d-97f73878c04d)


시스템 콜은 다음과 같은 과정을 거쳐 처리된다.<br>

1) 사용자 프로그램에서 시스템 콜 호출 <br>
   - 편의상 API 등의 함수호출로 이루어진다. (open() 등) <br>
   - 사용자 프로그램은 시스템 콜을 호출할 때 해당 기능에 필요한 매개변수들을 전달한다. <br>
   이 매개변수들은 보통 레지스터(register)에 저장되거나 스택(stack)에 전달된다. <br>
2) 인터럽트 발생 <br>
   - CPU는 운영체제가 처리할 수 있도록 제어를 인터럽트 처리 루틴(IPR)으로 넘긴다. 
2) 커널 모드로 전환 <br>
   - 사용자 모드에서 시스템 콜을 호출 받은 운영체제는 특권 모드로 커널모드로 전환한다.  <br>
3) 시스템 콜 실행 <br>
   - 요청된 작업을 처리한다. 아래의 명령어 등을 사용한다.  <br>
4) 사용자 모드 복귀 <br>
   - 작업 완료 후 다시 사용자 모드로 전환한다. 시스템은 시스템 콜 이후의 작업을 계속 수행한다. <br>

   
## 시스템 콜 유형 

**1) 프로세스 제어(Process Control)** <br>
  - 끝내기(exit), 중지(abort)<br>
  - 적재(load), 실행(execute)<br>
  - 프로세스 생성(create process) - fork<br>
  - 프로세스 속성 획득과 속성 설정<br>
  - 시간 대기(wait time)<br>
  - 사건 대기(wait event)<br>
  - 사건을 알림(signal event)<br>
  - 메모리 할당 및 해제<br>
  
**2) 파일 조작(File Manipulation)** <br>
  - 파일 생성/삭제 (create, delete)<br>
  - 열기/닫기/읽기/쓰기 (open, close, read, write)<br>
  - 위치 변경(reposition)<br>
  - 파일 속성 획득 및 설정(get file attribute, set file attribute) <br>
  
**3) 디바이스 조작(Device Manipulation)** <br>
  - 하드웨어의 제어와 상태 정보를 얻음(ioctl) <br>
  - 장치를 요구(request device), 장치를 방출(release device) <br>
  - 읽기(read), 쓰기(write), 위치 변경 <br>
  - 장치 속성 획득 및 설정 <br>
  - 장치의 논리적 부착 및 분리 <br>
  
**4) 정보 유지(Information Maintenance)** <br>
  - getpid(), alarm(), sleep() <br>
  - 시간과 날짜의 설정과 획득(time) <br>
  - 시스템 데이터의 설정과 획득(date) <br>
  - 프로세스 파일, 장치 속성의 획득 및 설정 <br>
  
**5) 통신(Communication)** <br>
  - pipe(), shm_open(), mmap() <br>
  - 통신 연결의 생성, 제거 <br>
  - 메시지의 송신, 수신 <br>
  - 상태 정보 전달 <br>
  - 원격 장치의 부착 및 분리 <br>
  
**6) 보호(Protection)** <br>
  - chmod() <br>
  - unmask() <br>
  - chown() <br>




#### 출처
https://luckyyowu.tistory.com/133
