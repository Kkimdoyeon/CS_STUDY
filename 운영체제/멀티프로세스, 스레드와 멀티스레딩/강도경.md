# 멀티 프로세스

## 의미 

- **하나의 응용 프로그램을 여러 개의 프로세스로 구성하여 각 프로세스가 하나의 작업을 처리하도록 하는 것**
- 2개 이상의 프로세스가 동시에 실행
- 동시 : 
    - 동시성 : 
        - CPU core가 1개일 때, 여러 process를 짧은 시간동안 번갈아 가면서 연산을 하게 되는 시분할 시스템으로 실행되는 것
    - 병렬성 :
        - CPU core가 여러개일 때, 각각의 core가 각각의 process를 연산함으로써 process가 동시에 실행되는 것

        |동시성|병렬성|
        |-----|-----|
        |Single core|Multi core|
        |동시에 실행되는 것 같아 보인다|실제로 동시에 여러 작업이 처리된다|
- CPU는 한번에 한가지 명령어밖에 처리하지 못함
- 멀티 프로세스는 동시에 여러 프로세스가 실행되는 것이 아니라 재빠르게 프로세스를 번갈아가며 실행하고 관리하는 것

<br/>

### Context Switching 

- CPU가 프로세스를 번갈아가며 실행하고 관리하는 것
- CPU에서 여러 프로세스를 돌아가면서 작업을 처리하는 과정
- 동작 중인 프로세스가 대기하면서 해당 프로세스의 상태 (Context)를 PCB (Process Control Block)에 보관
- 대기하고 있던 다음 순서의 프로세스가 동작하며 이전에 PCB에 보관했던 프로세스의 상태를 복구

<br/>

### PCB (Process Control Block) 

- 특정한 프로세스를 관리할 필요가 있는 정보를 포함하는 운영체제 커널의 자료구조
- Context Switching시 사용
- CPU가 여러 프로세스를 빠르게 번갈아가며 작업하기 위해서는 프로세스에 대한 정보 및 상태를 저장/복원 할 필요가 있기 때문
- PCB에 포함되는 항목 : 
    1. 프로세스 식별자, 상태, 카운터, 계정 정보
    2. CPU 레지스터, 스케쥴링 정보
    3. 메모리 관리 정보
    4. 입출력 상태 정보

<br/>

### 장점 
    
- 여러개의 자식 프로세스 중 하나에 문제가 발생하면 그 자식 프로세스만 죽음
- 문제가 발생하면 영향이 확산되지 않음

<br/>

### 단점 
    
- Context Switching 과정에서 캐시 메모리 초기화 등 무거운 작업이 진행되고 많은 시간이 소모되는 등 오버헤드가 발생
- 프로세스는 각각의 독립된 메모리 영역을 할당받았기 때문에 프로세스 사이에서 공유하는 메모리가 없어 Context Switching이 발생하면 캐시에 있는 모든 데이터를 리셋하고 다시 캐시 정보를 불러와야 함

<br/>

# 멀티 스레드

## 의미 

- **하나의 프로세스 내에서 둘 이상의 스레드가 동시에 작업을 수행하는 것**
- 하나의 응용 프로그램을 여러 개의 스레드로 구성하고 각 스레드가 하나의 작업을 처리
- 원도우, 리눅스 등 여러 OS가 멀티 프로세싱을 지원하고 있지만 멀티 스레딩을 기본으로 함
- 웹 서버는 대표적인 멀티 스레딩 응용 프로그램
- 병렬성(Parallelism)을 높일 수 있음
- 여러 작업이 동시에 수행될 수 있음
- 프로세스의 스레드들이 각각 다른 프로세서에서 병렬적으로 수행될 수 있기 때문

<br/>

# 멀티 스레딩

## 의미

- 하나의 프로세스를 다수의 실행 단위로 구분하여 자원을 공유하고 자원의 생산과 관리의 중복성을 최소화하여 수행 능력을 향상하는 것
- 여러 개의 스레드를 통해 하나의 프로그램에서 동시에 여러 개의 일을 수행할 수 있도록 해주는 것

### 장점

- **시스템 자원소모 감소 (자원의 효율성 증대)**
    - 프로세스를 생성하여 자원을 할당하는 시스템 콜이 줄어 자원을 효율적으로 관리
    -  CPU의 사용률을 높이고 메모리 자원을 효과적으로 사용함으로써 시스템의 효율을 극대화
    - 여러 스레드가 동시에 실행되기 때문에 I/O 작업이나 네트워크 작업으로 인해 발생하는 대기 시간을 다른 스레드가 계산 작업을 하는 데 사용
- **시스템 처리율 향상 (처리비용 감소)**
    - 스레드 간 데이터를 주고 받는 것이 간단해지고 시스템 자원 소모가 줄어듦
    - 스레드 사이 작업량이 작아 Context Switching이 빠름
    - 캐시 메모리를 비울 필요가 없음
- **간단한 통신 방법으로 프로그램 응답시간 단축**
    - 스레드는 프로세스 내 스택영역을 제외한 메모리 영역을 공유하기에 통신 비용이 적음
    - 힙 영역을 공유하므로 데이터를 주고 받을 수 있음
    - 무거운 작업을 하는 동안에도 빠르게 반응
- **병렬 처리 가능**
    - 멀티스레딩을 통해 각 코어가 다른 스레드를 동시에 처리함으로써 병렬적으로 작업을 수행
    - 병렬 컴퓨팅은 작업의 처리 속도를 대폭 향상

<br/>

### 단점

- 자원을 공유하기에 동기화 문제가 발생 (병목현상, 데드락 등)
- 서로 다른 스레드가 전역 변수 공간인 Data 영역, 동적 할당 공간인 Heap 영역 등을 공유하여 어떤 스레드가 다른 스레드에서 사용중인 변수나 자료구조에 접근하여 엉뚱한 값을 읽어오거나 수정할 수 있음
- 주의 깊은 설계가 필요하고 디버깅이 어려움
- 좀 더 복잡한 메커니즘을 제공해야 하며 이는 추가적인 비용을 요구
- 불필요 부분까지 동기화하면 대기시간으로 인해 성능저하 발생
- 하나의 스레드에 문제가 생기면 전체 프로세스가 영향을 받음
- 단일 프로세스 시스템의 경우 효과를 기대하기 어려움
- 자원을 공유하는 스레드의 수가 너무 많으면 오버헤드가 발생

<br/>


<br/>
<br/>
<br/>

### 참고 자료

- https://inpa.tistory.com/entry/%F0%9F%91%A9%E2%80%8D%F0%9F%92%BB-multi-process-multi-thread#1._%EC%8A%A4%EB%A0%88%EB%93%9C%EB%8A%94_%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4%EB%B3%B4%EB%8B%A4_%EA%B0%80%EB%B2%BC%EC%9B%80
- https://eunjinii.tistory.com/41
- https://wookkingkim.tistory.com/entry/%EB%A9%80%ED%8B%B0-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-vs-%EB%A9%80%ED%8B%B0-%EC%8A%A4%EB%A0%88%EB%93%9C
- https://wooody92.github.io/os/%EB%A9%80%ED%8B%B0-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4%EC%99%80-%EB%A9%80%ED%8B%B0-%EC%8A%A4%EB%A0%88%EB%93%9C/
- https://zhfvkq.tistory.com/12
- https://github.com/devSquad-study/2023-CS-Study/blob/main/OS/os_multi_procsss_thread_multi_thread.md
- https://engineerinsight.tistory.com/281#google_vignette
- https://murphymoon.tistory.com/entry/%EB%A9%80%ED%8B%B0%ED%94%84%EB%A1%9C%EC%84%B8%EC%8B%B1multiprocessing%EA%B3%BC-%EB%A9%80%ED%8B%B0%EC%8A%A4%EB%A0%88%EB%94%A9multithreading%EC%9D%98-%EC%B0%A8%EC%9D%B4%EC%A0%90-OS-%EB%A9%B4%EC%A0%91%EC%A7%88%EB%AC%B8-2
- https://gr-st-dev.tistory.com/2840#google_vignette
- https://velog.io/@hkh1213/%EB%A9%80%ED%8B%B0%EC%8A%A4%EB%A0%88%EB%94%A9%EC%9D%98-%EC%9E%A5%EC%A0%90-%EB%8B%A8%EC%A0%90
- https://technote-mezza.tistory.com/69